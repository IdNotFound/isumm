<!--
-- Parameters
-- .User
-- .LogoutUrl
-- .Investments
-->
<html>
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" href="static/app.css">
		<link rel="stylesheet" href="static/default_font.css">
	</head>
	<body>
  		<h1>Welcome {{.User}}!</h1>
		<div id="opDiv" class="op">
			<b>Operation</b>
			<form id="opForm" action="op" method="post">
				Type:<select name="type" form="opForm">
					<option value="1" selected>Balance</option>
					<option value="2">Deposit</option>
					<option value="3">Withdrawal</option>
				</select><br>
				Investiment:<select name="inv" form="opForm">
					<option value="">Please select</option>
					{{range .Investments}}
						<option value="{{.Key}}">{{.Name}}</option>
					{{end}}
				</select><br>
				Value:<input type="text" name="value"><br>
				Date:<input type="date" name="date"><br>
				<input type="submit" value="Submit">
			</form>
		</div>
		<div id="invDiv" class="op">
			<b>New Investiment</b>
			<form id="invForm" action="inv" method="post">
			    Edit:<select name="key" form="invForm">
					<option value="">Select to edit</option>
					{{range .Investments}}
						<option value="{{.Key}}">{{.Name}}</option>
					{{end}}
				</select><br>
				Name:<input type="text" name="name"><br>
				<input type="submit" value="Submit">
			</form>
		</div>
		<div>
			<table>
				{{range .Investments}}
					{{ $invKey := .Key}}
					<ul>
					<li>
						<form name="delInv" method="post" action="inv">
							<input type="hidden" name="key" value="{{$invKey}}">
							<input type="hidden" value="d" name="action">
							<input type="submit" value="-">
						</form>
						Investment: {{.Name}}
					</li>
					<ul>
						{{range .Ops}}
							<li>
							<form name="delOp" method="post" action="op">
								<input type="hidden" name="key" value="{{$invKey}}">
								<input type="hidden" value="d" name="action">
								<input type="submit" value="-">
							</form>
							<span>{{.Date.Format "2006-01-02"}}</span>||<span>{{.Type}}</span>||<span>{{.Value}}</span>
							</li>
						{{end}}
					</ul> <!-- operations -->
					</ul> <!-- Investments -->
				{{end}}
			</table>
		</div>
		<p><a href={{.LogoutUrl}}>Logout</a></p>
	</body>
</html>